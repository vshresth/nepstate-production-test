!function(t){function e(){var e=t(".rtcl-booking-type .rtcl-radio-field input[type=radio]:checked"),n=e.val(),o=e.closest(".rtcl-booking-holder"),i=o.find(".rtcl-booking-service-fields"),r=o.find(".rtcl-booking-event-fields"),a=o.find(".rtcl-booking-rent-fields"),c=o.find(".rtcl-booking-pre-order-fields");switch(n){case"event":default:i.slideUp(),a.slideUp(),c.slideUp(),r.slideDown();break;case"services":a.slideUp(),r.slideUp(),c.slideUp(),i.slideDown();break;case"rent":i.slideUp(),r.slideUp(),c.slideUp(),a.slideDown();break;case"pre_order":a.slideUp(),r.slideUp(),i.slideUp(),c.slideDown()}}function n(e,n){if("time"===n){var o,i,r,a={autoUpdateInput:!1,singleDatePicker:!0,timePicker:!0,timePicker24Hour:/H|HH/.test((null===(o=rtcl_booking.timePicker)||void 0===o||null===(i=o.locale)||void 0===i?void 0:i.format)||"hh:mm A"),timePickerIncrement:1},c=e.name;if(c&&c.includes("[end]")){var l={};l=rtcl_booking.timePickerEnd&&Object.keys(rtcl_booking.timePickerEnd).length?Object.assign({},rtcl_booking.timePicker,rtcl_booking.timePickerEnd||{}):rtcl_booking.timePicker,r=Object.assign({},a,l||{})}else r=Object.assign({},a,rtcl_booking.timePicker||{});t(e).daterangepicker(r).on("show.daterangepicker",(function(t,e){e.container.find(".calendar-table").hide()}))}t(e).on("apply.daterangepicker",(function(e,n){t(this).val(n.startDate.format(n.locale.format))})).on("cancel.daterangepicker",(function(e,n){t(this).val("")}))}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=document.getElementById("rtclBookingCalendar");e&&(new FullCalendar.Calendar(e,{initialView:"dayGridMonth",height:500,contentHeight:"auto",datesSet:function(){i(t)}}).render(),i(t))}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t(".fc-scrollgrid-sync-table tbody tr").each((function(n){var o=t(this);t("td",o).each((function(n){var o=t(this),i=o.data("date");e.includes(i)&&o.addClass("disable")}))}))}e(),t(document).ready((function(){var i=[],r=t("#rent_unavailable_date");r.length&&(i=r.val().split(",")),rtclFilter.add("dateRangePickerOptions",(function(t){return(Array.isArray(t.bookedDateList)&&t.bookedDateList.length||Array.isArray(t.pendingDateList)&&t.pendingDateList.length)&&(t.isCustomDate=function(e){return t.bookedDateList.length&&t.bookedDateList.includes(e.format(t.locale.format))?"booked":t.pendingDateList.length&&t.pendingDateList.includes(e.format(t.locale.format))?"pending":void 0}),t})),rtclInitDateField(),t(".rtcl-booking-type").on("change",".rtcl-radio-field input[type=radio]",(function(){t(this);e(),o(i)})),t.fn.daterangepicker&&t(".bhs-timepicker").each((function(){n(this,"time")})),t(".rtcl-my-booking-wrap").on("click",".rtcl-booking-pagination a",(function(e){e.preventDefault();var n=t(this),o=n.closest(".rtcl-booking-pagination"),i=o.closest(".rtcl-my-booking-wrap"),r=o.attr("data-per-page"),a=o.attr("data-booking"),c=n.attr("data-page");if(!n.hasClass("current")){o.find("a").removeClass("current"),n.addClass("current");var l={posts_per_page:r,page:c,pagination_for:a,action:"rtcl_booking_pagination",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce};t.ajax({url:rtcl_booking.ajax_url,data:l,type:"POST",beforeSend:function(){i.rtclBlock()},success:function(e){i.rtclUnblock(),i.find(".rtcl-single-booking-wrap").html(e),t("html, body").animate({scrollTop:t(".rtcl-MyAccount-wrap").offset().top-150},800)},error:function(t){console.log(t),i.rtclUnblock()}})}})),o(i),t(document).on("click","#rtclBookingCalendar .fc-scrollgrid-sync-table .fc-day",(function(e){var n=t(this),o=n.attr("data-date");if(!n.hasClass("fc-day-past")){var a=i.findIndex((function(t){return t===o}));a>=0?i.splice(a,1):i.push(o),n.toggleClass("disable"),r.val(i)}})),t(document).on("click",".rent-guest-quantity .plus-sign",(function(e){var n=t(this).closest(".rent-guest-quantity").find("#guest_number"),o=n.data("max"),i=n.val();if(++i>o)return alert("Maximum allowed "+o+" guests"),!1;n.val(i)})),t(document).on("click",".rent-guest-quantity .minus-sign",(function(e){var n=t(this).closest(".rent-guest-quantity").find("#guest_number"),o=n.val();if(--o<1)return!1;n.val(o)}));var a=t('<div class="calendar-status"><div class="status-available"><span>'+rtcl_booking.rent_calendar.available_text+'</span></div><div class="status-booked"><span>'+rtcl_booking.rent_calendar.booked_text+'</span></div><div class="status-pending"><span>'+rtcl_booking.rent_calendar.pending_text+'</span></div><div class="status-past"><span>'+rtcl_booking.rent_calendar.past_text+'</span></div><div class="status-active"><span>'+rtcl_booking.rent_calendar.active_text+"</span></div></div>");t("body.rent-type-booking").find(".daterangepicker .drp-buttons").before(a)})),t(document).on("click",".rtcl-booking-service-slots .rtcl-icon-plus",(function(e){e.preventDefault();var o=t(this),i=o.closest(".time-slot"),r=i.closest(".time-slots").find(".time-slot").length||0,a=t(i).clone();t(a).find("input[type='text']").each((function(){t(this).attr("name",t(this).attr("name").replace(/times\]\[([0-9]+)\]/i,"times]["+r+"]")),t(this).val("")})),t(a).find(".bhs-timepicker").each((function(){n(this,"time")})),o.removeClass("rtcl-icon-plus").addClass("rtcl-icon-minus"),t(i).after(t(a))})).on("click",".rtcl-booking-service-slots .rtcl-icon-minus",(function(e){if(e.preventDefault(),confirm(rtcl_booking.lang.confirm)){var n=t(this),o=n.closest(".time-slots");n.closest(".time-slot").remove(),o.find(".time-slot").each((function(e,n){t(this).find("input[type='text']").each((function(){t(this).attr("name",t(this).attr("name").replace(/times\]\[([0-9]+)\]/i,"times]["+e+"]"))}))}))}})),t(".rtcl-listing-booking-wrap").on("change","#booking_date",(function(){var e=t(this),o=e.closest(".rtcl-listing-booking-wrap"),i=t("<div class='alert rtcl-response'></div>"),r=o.find("form"),a={post_id:r.find("#listing_id").val(),booking_date:t(this).val(),action:"rtcl_booking_service_day_slots",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce};t.ajax({url:rtcl_booking.ajax_url,data:a,type:"POST",beforeSend:function(){r.find(".alert.rtcl-response").remove(),r.find("#service_slots").remove(),r.find("button[type=submit]").prop("disabled",!0),r.rtclBlock()},success:function(o){r.find("button[type=submit]").prop("disabled",!1),r.rtclUnblock(),t(o).insertAfter(e),r.find(".bhs-timepicker").each((function(){n(this,"time")}))},error:function(t){i.removeClass("alert-success").addClass("alert-danger").html(t.responseText).appendTo(r),r.find("button[type=submit]").prop("disabled",!1),r.rtclUnblock()}})})).on("change keyup","#no_of_ticket",(function(){var e=t(this),n=e.closest(".rtcl-listing-booking-wrap"),o=n.find("form"),i=n.find(".rtcl-booking-cost"),r=e.val()?e.val():1,a=o.find("#booking_fee").val();i.find("span > span").text(r*a)})).on("change keyup","#booking_rent_date",(function(){var e=t(this),n=e.closest(".rtcl-listing-booking-wrap"),o=n.find("form"),i=n.find(".rtcl-booking-cost"),r=e.val(),a=n.find("#post_id").val();t.ajax({url:rtcl_booking.ajax_url,data:{post_id:a,booking_date:r,action:"rtcl_booking_rent_fee_calculation",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){o.rtclBlock()},success:function(t){o.rtclUnblock(),t.status&&i.find("span > span").text(t.fee)},error:function(t,e,n){o.rtclUnblock()}})})),t(document).on("submit",".rtcl-listing-booking-wrap form",(function(e){e.preventDefault();var n=t(this).closest(".rtcl-listing-booking-wrap"),o=t("<div class='alert rtcl-response'></div>"),i=n.find("form"),r=i.find("#no_of_ticket").val(),a=i.find("#guest_number").val(),c=i.find("#booking_date").val(),l=i.find("#booking_rent_date").val(),s=i.find("#service_slot").val(),d=i.find("input#post_id").val();t.ajax({url:rtcl_booking.ajax_url,data:{post_id:d,no_of_ticket:r,no_of_guest:a,time_slot:s,booking_date:c,booking_rent_date:l,action:"rtcl_booking_verification",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){i.find(".alert.rtcl-response").remove(),i.find("button[type=submit]").prop("disabled",!0),i.rtclBlock()},success:function(t){i.rtclUnblock();var e="";t.message.length&&(e+="<p>"+t.message+"</p>"),t.error?(i.find("button[type=submit]").prop("disabled",!1),e&&o.removeClass("alert-success").addClass("alert-danger").html(e).appendTo(i)):(e&&o.removeClass("alert-danger").addClass("alert-success").html(e).appendTo(i),t.redirect_url&&setTimeout((function(){window.location.href=t.redirect_url}),500))},error:function(t,n,r){o.removeClass("alert-success").addClass("alert-danger").html(e.responseText).appendTo(i),i.find("button[type=submit]").prop("disabled",!1),i.rtclUnblock()}})})),t(document).on("submit",".rtcl-booking-confirmation-wrapper form",(function(e){e.preventDefault();var n=t(this).closest(".rtcl-booking-confirmation-wrapper"),o=t("<div class='alert rtcl-response'></div>"),i=n.find("form"),r=new FormData(this);r.append("__rtcl_wpnonce",rtcl_booking.__rtcl_wpnonce),r.append("action","rtcl_booking_confirmation"),t.ajax({url:rtcl_booking.ajax_url,data:r,cache:!1,contentType:!1,processData:!1,type:"POST",beforeSend:function(){i.find(".alert.rtcl-response").remove(),i.find("button[type=submit]").prop("disabled",!0),i.rtclBlock()},success:function(t){i.rtclUnblock();var e="";t.message.length&&t.message.map((function(t){e+="<p>"+t+"</p>"})),t.success?(e&&o.removeClass("alert-danger").addClass("alert-success").html(e).appendTo(i),t.redirect_url&&setTimeout((function(){window.location.href=t.redirect_url}),500)):(i.find("button[type=submit]").prop("disabled",!1),e&&o.removeClass("alert-success").addClass("alert-danger").html(e).appendTo(i))},error:function(t,n,r){o.removeClass("alert-success").addClass("alert-danger").html(e.responseText).appendTo(i),i.find("button[type=submit]").prop("disabled",!1),i.rtclUnblock()}})})),t(".rtcl-my-booking-wrap").on("click","#approve-booking",(function(e){e.preventDefault();var n=t(this),o=n.closest(".single-booking"),i='<button id="cancel-booking" class="btn btn-primary">'+rtcl_booking.cancel_text+"</button>",r=o.attr("data-id"),a=o.attr("data-booking-id");t.ajax({url:rtcl_booking.ajax_url,data:{post_id:r,booking_id:a,action:"rtcl_booking_request_approve",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){n.prop("disabled",!0),o.rtclBlock()},success:function(t){n.prop("disabled",!1),t.success?(toastr.success(t.message),o.find(".booking-status").text(rtcl_booking.approve_text),o.find(".booking-btn").html(i)):toastr.error("Something Wrong!"),o.rtclUnblock()},error:function(t){console.log(t),n.prop("disabled",!1),o.rtclUnblock()}})})).on("click","#reject-booking",(function(e){e.preventDefault();var n=t(this),o=n.closest(".single-booking"),i='<button id="delete-booking" class="btn btn-danger">'+rtcl_booking.delete_text+"</button>",r=o.attr("data-id"),a=o.attr("data-booking-id");t.ajax({url:rtcl_booking.ajax_url,data:{post_id:r,booking_id:a,action:"rtcl_booking_request_reject",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){n.prop("disabled",!0),o.rtclBlock()},success:function(t){n.prop("disabled",!1),t.success?(toastr.success(t.message),o.find(".booking-status").text(rtcl_booking.reject_text),o.find(".booking-btn").html(i)):toastr.error("Something Wrong!"),o.rtclUnblock()},error:function(t){console.log(t),n.prop("disabled",!1),o.rtclUnblock()}})})).on("click","#cancel-booking",(function(e){e.preventDefault();var n=t(this),o=n.closest(".single-booking"),i='<button id="delete-booking" class="btn btn-danger">'+rtcl_booking.delete_text+"</button>",r=o.attr("data-id"),a=o.attr("data-booking-id");t.ajax({url:rtcl_booking.ajax_url,data:{post_id:r,booking_id:a,action:"rtcl_booking_request_cancel",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){n.prop("disabled",!0),o.rtclBlock()},success:function(t){n.prop("disabled",!1),t.success?(toastr.success(t.message),o.find(".booking-status").text(rtcl_booking.canceled_text),o.find(".booking-btn").html(i)):toastr.error("Something Wrong!"),o.rtclUnblock()},error:function(t){console.log(t),n.prop("disabled",!1),o.rtclUnblock()}})})).on("click","#delete-booking",(function(e){e.preventDefault();var n=t(this),o=n.closest(".single-booking"),i=o.attr("data-id"),r=o.attr("data-booking-id");t.ajax({url:rtcl_booking.ajax_url,data:{post_id:i,booking_id:r,action:"rtcl_booking_delete_data",__rtcl_wpnonce:rtcl_booking.__rtcl_wpnonce},type:"POST",beforeSend:function(){n.prop("disabled",!0),o.rtclBlock()},success:function(t){n.prop("disabled",!1),t.success?(toastr.success(t.message),o.slideUp().remove()):toastr.error("Something Wrong!"),o.rtclUnblock()},error:function(t){console.log(t),n.prop("disabled",!1),o.rtclUnblock()}})}))}(jQuery);
